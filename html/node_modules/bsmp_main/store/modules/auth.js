import * as types from '../mutation-types';

const state = {
  params: null, // 登录参数
  user: null // 登录用户信息
};

const mutations = {
  /**
   * 登录操作
   * @param state
   * @param params
   */
  [types.TO_LOGIN] (state, params) {
    state.params = params;

    // 重置登录结果信息
    state.user = {data: null, time: new Date()};
    if (params && params.remember && window.sessionStorage) {
      window.sessionStorage.setItem('remember', JSON.stringify(params));
    }
  },

  /**
  * 登录成功
  * @param state
  * @param data
  */
  [types.LOGIN_SUCCESS] (state, data) {
    if (data && data.code === '0') {
      state.user = {data: data.data, time: new Date()};
      window.sessionStorage.setItem('user', JSON.stringify(data));
    }
  },

  /**
   * 登出成功
   * @param state
   * @param data
   */
  [types.LOGOUT_SUCCESS] (state, data) {
    if (data && data.code === '0') {
      state.user = {data: null, time: new Date()};
    }
  }
};

export default {
  state,
  mutations
};
